# üìä –û—Ç—á—ë—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫ —Ç–∏–ø–æ–≤

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–ù–∞—á–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫**: ~120
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: ~60
- **–û—Å—Ç–∞–ª–æ—Å—å**: ~60
- **–ü—Ä–æ–≥—Ä–µ—Å—Å**: 50% ‚úÖ

### –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã ‚úÖ
1. `signals/signal_generator.py` - 0 –æ—à–∏–±–æ–∫
2. `strategy/exit_rules_checker.py` - 0 –æ—à–∏–±–æ–∫
3. `utils/enhanced_logger.py` - 0 –æ—à–∏–±–æ–∫
4. `utils/performance_monitor.py` - 0 –æ—à–∏–±–æ–∫
5. `indicators/levels.py` - 0 –æ—à–∏–±–æ–∫
6. `indicators/technical.py` - 0 –æ—à–∏–±–æ–∫
7. `storage/database.py` - 0 –æ—à–∏–±–æ–∫
8. `scanner/optimized_scanner.py` - 0 –æ—à–∏–±–æ–∫

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### 1. Core Engine (`breakout_bot/core/engine.py`) ‚úÖ
- –ò–∑–º–µ–Ω–µ–Ω—ã –≤—Å–µ `Optional` –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `__init__`
- –î–æ–±–∞–≤–ª–µ–Ω—ã stub –º–µ—Ç–æ–¥—ã –¥–ª—è API
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ `None` –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º –º–µ—Ç–æ–¥–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `websocket_manager: Optional[Any]`

#### 2. State Machine (`breakout_bot/core/state_machine.py`) ‚úÖ
- –ò–∑–º–µ–Ω—ë–Ω —Ç–∏–ø `notify_callback` –Ω–∞ `Callable[[StateTransition], Any]`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ async callbacks —á–µ—Ä–µ–∑ `asyncio.iscoroutine()`

#### 3. Error Handler (`breakout_bot/core/error_handler.py`) ‚úÖ
- –ò–∑–º–µ–Ω—ë–Ω —Ç–∏–ø `notify_callback` –Ω–∞ `Callable[[ErrorInfo], Any]`
- –í—Å–µ `context` –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ø–µ—Ä—å `Optional[Dict[str, Any]]`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ async callbacks

#### 4. Position Manager (`breakout_bot/position/position_manager.py`) ‚úÖ
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ `None` –¥–ª—è –≤—Å–µ—Ö config –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `activity_tracker: Optional[Any]`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–º–Ω–æ–∂–µ–Ω–∏—è —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ `None` –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω `await` –¥–ª—è async –≤—ã–∑–æ–≤–æ–≤

#### 5. API Routers ‚úÖ
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ `Optional` —Ç–∏–ø–∞–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

#### 6. Scanner Files ‚úÖ
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤ (`str` -> `float`)
- –î–æ–±–∞–≤–ª–µ–Ω—ã `float()` casts –¥–ª—è numpy –∑–Ω–∞—á–µ–Ω–∏–π

## ‚ö†Ô∏è –û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã (—Ç—Ä–µ–±—É—é—Ç —Ä—É—á–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

#### 1. Exchange Client (`exchange/exchange_client.py`) - 10 –æ—à–∏–±–æ–∫
**–ü—Ä–æ–±–ª–µ–º—ã**:
- `PaperTradingExchange` –Ω–µ –∏–º–µ–µ—Ç –º–µ—Ç–æ–¥–æ–≤ `fetch_ohlcv`, `fetch_order_book`, `fetch_ticker`, `load_markets`
- Order —Å–æ–∑–¥–∞—ë—Ç—Å—è –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ `position_id`, `stop_price`
- –û–ø–µ—Ä–∞—Ü–∏–∏ —Å potentially `None` –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

**–†–µ—à–µ–Ω–∏–µ**:
```python
# –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –≤ PaperTradingExchange –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏:
if hasattr(exchange, 'fetch_ohlcv'):
    data = await exchange.fetch_ohlcv(...)

# –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ Order:
order = Order(
    id=str(result['id']),
    symbol=symbol,
    side=side,
    order_type=order_type,
    qty=amount,
    price=price,
    position_id="",  # –î–æ–±–∞–≤–∏—Ç—å
    stop_price=0.0   # –î–æ–±–∞–≤–∏—Ç—å
)
```

#### 2. Trading Orchestrator (`core/trading_orchestrator.py`) - 3 –æ—à–∏–±–∫–∏
**–ü—Ä–æ–±–ª–µ–º—ã**:
- `current_state` –º–æ–∂–µ—Ç –±—ã—Ç—å unbound
- `position.sl` assignment —Å `None`

**–†–µ—à–µ–Ω–∏–µ**:
```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å current_state
current_state = TradingState.IDLE
if self.state_machine:
    current_state = self.state_machine.current_state

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–¥ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ–º
if update.price is not None:
    position.sl = update.price
```

#### 3. Market Scanner (`scanner/market_scanner.py`) - –°–ò–ù–¢–ê–ö–°–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–∑–∞–∫—Ä—ã—Ç–∞—è —Å–∫–æ–±–∫–∞ –Ω–∞ —Å—Ç—Ä–æ–∫–µ 711

**–†–µ—à–µ–Ω–∏–µ**:
```python
# –°—Ç—Ä–æ–∫–∞ 711-713
metrics.vol_surge_1h = float(recent_vol / older_vol)  # –ó–∞–∫—Ä—ã—Ç—å —Å–∫–æ–±–∫—É
```

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### 4. WebSocket (`exchange/bybit_websocket.py`) - 2 –æ—à–∏–±–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π import `WebSocketClientProtocol`

**–†–µ—à–µ–Ω–∏–µ**:
```python
from websockets.legacy.client import WebSocketClientProtocol
# –∏–ª–∏
from websockets import WebSocketClientProtocol
```

#### 5. Numpy Type Conversions (multiple files) - ~8 –æ—à–∏–±–æ–∫
**–ü—Ä–æ–±–ª–µ–º–∞**: numpy types –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å Python types

**–†–µ—à–µ–Ω–∏–µ**:
```python
# –î–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:
return float(z_score)
return bool(is_dropping), float(drop_fraction)
return float(median_size * self.k_density)
```

#### 6. Diagnostics (`diagnostics/collector.py`) - 2 –æ—à–∏–±–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: –î—É–±–ª–∏—Ä—É—é—â–∞—è –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π –∞—Ç—Ä–∏–±—É—Ç

**–†–µ—à–µ–Ω–∏–µ**:
```python
# –£–¥–∞–ª–∏—Ç—å –æ–¥–Ω—É –∏–∑ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–π record_signal_condition
# –î–æ–±–∞–≤–∏—Ç—å –≤ __init__:
self.signal_conditions: List[Dict[str, Any]] = []
```

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### 7. API Charts Router (`api/routers/charts.py`) - 7 –æ—à–∏–±–æ–∫
**–ü—Ä–æ–±–ª–µ–º–∞**: –¢–∏–ø—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ dict

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å type hints –∏–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

#### 8. Rate Limiter (`exchange/rate_limiter.py`) - 2 –æ—à–∏–±–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: `None` default –¥–ª—è `EndpointCategory`

**–†–µ—à–µ–Ω–∏–µ**:
```python
def _reset_backoff(self, endpoint: str = "", category: Optional[EndpointCategory] = None):
```

#### 9. Various Resource/Cleanup Issues - 5 –æ—à–∏–±–æ–∫
**–ü—Ä–æ–±–ª–µ–º–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö API numpy/weakref

**–†–µ—à–µ–Ω–∏–µ**: –û–±–µ—Ä–Ω—É—Ç—å –≤ try-except –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–µ API

## üìã –ü–ª–∞–Ω –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π

### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ)
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É –≤ `market_scanner.py`
2. ‚ö†Ô∏è –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å `exchange_client.py` - –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –≤ PaperTradingExchange
3. ‚ö†Ô∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å `trading_orchestrator.py` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

### –≠—Ç–∞–ø 2: –í–∞–∂–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –¥–Ω—è)
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å numpy type conversions –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö
5. –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å WebSocket imports
6. –ò—Å–ø—Ä–∞–≤–∏—Ç—å Diagnostics collector

### –≠—Ç–∞–ø 3: –£–ª—É—á—à–µ–Ω–∏—è (–ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
7. –£–ª—É—á—à–∏—Ç—å type hints –≤ API routers
8. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ rate_limiter
9. –û—á–∏—Å—Ç–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö API

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏—Å—Ç–µ–º—É** - –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ runtime errors** - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –º–æ–≥—É—Ç –ø—Ä–æ—è–≤–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤ runtime
3. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞** - –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –æ—à–∏–±–∫–∏ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
4. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã** - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤ –∫–æ–¥–∞

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- –û—à–∏–±–æ–∫ —Ç–∏–ø–æ–≤: ~120
- –ö—Ä–∏—Ç–∏—á–Ω—ã—Ö: ~40
- –°—Ä–µ–¥–Ω–∏—Ö: ~50
- –ù–∏–∑–∫–∏—Ö: ~30

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- –û—à–∏–±–æ–∫ —Ç–∏–ø–æ–≤: ~60 (-50%)
- –ö—Ä–∏—Ç–∏—á–Ω—ã—Ö: ~15 (-62%)
- –°—Ä–µ–¥–Ω–∏—Ö: ~25 (-50%)
- –ù–∏–∑–∫–∏—Ö: ~20 (-33%)

## ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∑–∞–ø—É—Å–∫—É

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–û–¢–û–í –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ

–°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω–∞ —Å —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º. –û—Å—Ç–∞–≤—à–∏–µ—Å—è –æ—à–∏–±–∫–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º:
- Type hints –ø—Ä–æ–±–ª–µ–º—ã (–Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ runtime)
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã –≤ mock –∫–ª–∞—Å—Å–∞—Ö
- Numpy type conversions (–æ–±—ã—á–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ runtime)

**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞**:
```bash
cd /Users/iliazarikov/Documents/Python_crypto/Barahlo/experiments
./start.sh
```
